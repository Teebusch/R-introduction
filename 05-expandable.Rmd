# R is expandable

:::{ .goals }
* What is an R package?
* How to install and load an R package?
* What is the *Tidyverse*?
* Loading data from a text file into R
* Getting an overview of a data frame
:::

While R is not as popular or as fast as other programming languages, it is quite popular in the data analysis and research domain. As a result, R gives you access to a vast amount of amazing packages written by expert statisticians and programmers around the world. An R package is a collection of R code that has been bundled up so that it can be easily used by others. The full power of R unfolds when you tap into this vast ecosystem of
packages. There are literally tens of thousands of packages to make your life
easier! There's an R package for almost everything! See for yourself at
[rdrr.io](https://rdrr.io/) or [Metacran](https://www.r-pkg.org/).

Packages in [CRAN](https://cran.r-project.org/),
[BioConductor](https://www.bioconductor.org/), and
[Neuroconductor](https://neuroconductor.org/)) are peer-reviewed and often
written by domain experts. Many more packages are available on
[Github](https://github.com/topics/r?l=r). And if there's ever anything missing
you can build it yourself -- together with others across the globe. [It's fun
and you will learn a
lot!](https://www.rstudio.com/resources/rstudioglobal-2021/make-a-package-make-some-friends/)

By the way: R can also integrate with
[Python](https://rstudio.github.io/reticulate/), [C](http://www.rcpp.org/), and
other languages and interface with other software, such as
[MPLUS](https://mclust-org.github.io/mclust/).

You can also rite your own R package. The R Packages book provides a deep dive into writing and publishing R packages.

## Introducing the Tidyverse

[**The Tidyverse**](https://www.tidyverse.org/) is a set of R packages that
share a common design philosophy. It aims to provide consistent user-friendly
verb-based functions for common data-tasks and to iron out many of the
idiosyncrasies of *Base R*. The **Tidy Data** that gives the Tidyverse its name
is a table with

  * one observation per row
  * one variable per column
  * column names that are easy to type and easy to remember

The core idea is that, once the data is in *tidy* format, all the Tidyverse
functions can be used seamlessly. A special operator, the pipe `%>%` (see
below), glues all the functions together.

The Tidyverse is a relatively recent addition to the R package ecosystem but the
design philosophy has struck a chord with the R developer community and
many packages are now following Tidyverse principles. As a result, the overall
data analysis workflow in R has become more streamlined and integrated over
the last few years. Nevertheless, some people prefer base R, and many older
packages will never change to a "tidy" design. Moreover, there are other popular
alternatives to the Tidyverse, such as the
[`{data.table}`](https://rdatatable.gitlab.io/data.table/) package. This leads
to a bit of a schism in the R package ecosystem.

## Installing packages

For the examples in this book we will use a table with information about climbing expeditions in the Himalaya that was provided by [Tidy Tuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-09-22/readme.md).

Often you will read data from external sources and the first step is to turn it into something that R can work with, usually a data frame. In this case, the data is provided as a *CSV* file. CSV stands for comma separated values and is a popular plain text format for sharing tabular data across the internet.^[Excel files are bad for sharing data! [Learn from the mistakes of others](https://www.theverge.com/2020/8/6/21355674/human-genes-rename-microsoft-excel-misreading-dates) and instead use CSV, JSON, [Feather](https://blog.rstudio.com/2016/03/29/feather/), [databases](https://db.rstudio.com/databases/sqlite/), ...]

To read the CSV file and turn it into an R data frame we will use the `read_csv()`
function. To use this function, we first have to install and load the `{tidyverse}` package.^[ 
Usually, **packages** are collections of functions. The `{tidyverse}` package is a bit different, as it is actually a collection of other packages --- a *meta-package*. When you load it, it loads the most popular packages from theTidyverse, such as `{ggplot2}`, `{readr}`, and `{dplyr}`. For example, the `read_csv()` function is from the `{readr}` package.]

You can install the package from R's central package repository CRAN. The `install.packages()` function looks for a package of a given name on CRAN, and if it finds it installs it. The `library()` function loads a package that you have installed, so that all of its functions become available for you to use in your current R session. The next time you start RStudio, you will not have to reinstall the package (it is now on your computer), but you will have to load it again.

```{r eval=FALSE}
install.packages("tidyverse")
library(tidyverse)
```

:::{.more}
The distinction between library and package can be a little confusing. It might help to imagine that you are *adding a package to your system's library of packages* with `install.packages()`, and then you use `library()` to *check out a package from your library*, so that you can use it in your current R session.

Note also that the quotation marks around the package name in `intall.packages()` are required, because this is essentially a search term. In `library()` the quotation marks are optional, because the package is an object in your library, from where you can call it by its name like any other variable.
:::

## Loading data

Now that we have the `{tidyverse}` package installed and loaded, we can use the `read_csv()` function to load the data straight from the web into an R data frame in our computer's working memory.

```{r}
peaks <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-22/peaks.csv')
```

## Inspecting the data

When we load the data, R shows us the names of the columns in the data set and the type of each column. 
We can also have a look at the first few rows with the `head()` function.

```{r}
head(peaks)
```

You can get a more traditional spreadsheet-like view of the complete data frame by
clicking its name in the Environment panel or running the command `view(peaks)`.

To better understand our data, let's get some summary statistics. The `{skimr}`
package provides a really nice function for this. 

:::{ .exercise }
Install and load the `{skimr}` package from CRAN.

:::{ .answer}
```{r eval = FALSE}
install.packages("skimr")
library(skimr)
```
:::
:::

Now we can "skim" our data:

```{r} 
skim(peaks)
```

This summary tells us quite a lot about our data! For example, we can
see that some peaks have not been successfully climbed until very recently, or not at
all. There also appears to be an outlier in the `first_ascent_year` column that we'll 
have to take care of -- a peak that was successfully climbed in the year 201.

:::{ .more }
**The :: operator.** 

We only use one function from the `{skimr}` package, and we only use it this one time. 
In a case like this, it may save you some typing by calling the function directly, without loading the package first. 
`::` between the package name and
the function name. This is a way . Thus, 

```{r eval = FALSE}
skimr::skim(peaks)
```

is equivalent to

```{r eval=FALSE} 
library(skimr)
skim(peaks)
```

The `::` is often used when the package is only needed for a single function
call or to clarify (either to R or to the person reading the code) which package a
function is coming from. This is particularly useful when there are functions
with the same name in different packages. Another approach to solving this
problem is the [`{conflicted}`](https://conflicted.r-lib.org/) package. 
:::
